---
title: "Spatial Suppression Messmodelle"
author: "Kongenerisches- und fixed-links Modelle im Vergleich"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
    toc: false
    toc_depth: 3
classoption: a4paper
---

```{r setup, include=FALSE}
opts_chunk$set(dev = 'pdf')
```

```{r, echo = FALSE}
resultsSupp2 <- read.csv("hicksupp.csv", sep = ",")
```

#1 Zusammenhänge der Bedingungen
```{r, echo=FALSE}
corr.test(resultsSupp2[12:15])
```


#2 Kongenerisches Modell
```{r, echo=FALSE, fig.align='center'}
congenericSupp2 <- 'gSupp2 =~ S1mean + S2mean + S3mean + S4mean'

# .... 1.2 fit -----------------------------------------------------------------
congenericSupp2Fit <- sem(congenericSupp2,
                     data      = resultsSupp2,        #Datensatz mit den in sem.model verwendeten Variable
                     estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
                     mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)

# .... 1.5 Plotten -------------------------------------------------------------
semPaths(congenericSupp2Fit,
         what           = "std",           #std, or est
         style          = "lisrel",        #lisrel, or mx
         layout         = "tree",          #tree, circle, or spring
         structural     = F,               #or T for structural model only
         cut            = .60,            #cut the scaling of the paths (edges) at this value
         residScale     = 7,               #size of residual paths (edges)
         sizeMan        = 7,               #size of the manifest variables
         sizeLat        = 5,               #size of the latent variables
         intercepts     = F,               #should intercepts be included?
         optimizeLatRes = T,               #angle of the incoming residuals is optimized
         exoVar         = T,               #should variances of exo variables be plotted?
         nCharNodes     = 0,               #number of characters to abbreviate node labels
         asize          = 1.5,             #arrow head size
         esize          = 1,               #arrow wheight
         edge.color     = 1,               #path (edge) color (1-255)
         edge.label.cex = .5,              #path (edge) label size
         cardinal       = F,               #or T for arrows pointing in the middle of a variable
         nDigits        = 3,               #number of digits for coeffiecients
         rotation       = 1)               #
```



Chi-Square | df   |     *p* | CFI |   RMSEA   | SRMR | parsimony ratio |
---------- | ---- | ------- | --- | --------- | ---- | --------------- |
      46.8 |   2  |  < .001 | .63 | .30 - .41 | .09  |             .33 |




#3 *fixed-links* Modelle
```{r, echo=FALSE, fig.align='center'}
# .... 2.1 model specification -------------------------------------------------
flSupp2 <- 'C   =~ 1* S1mean + 1* S2mean + 1* S3mean + 1* S4mean
           exp =~ 1*S1mean +  4*S2mean + 9*S3mean + 16*S4mean

           C ~~ 0*exp
           '

# .... 2.2 fit -----------------------------------------------------------------
flSupp2Fit <- sem(flSupp2,
                     data      = resultsSupp2,        #Datensatz mit den in sem.model verwendeten Variable
                     estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
                     mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)

# .... 2.5 Plotten -------------------------------------------------------------
semPaths(flSupp2Fit,
         what           = "std",           #std, or est
         style          = "lisrel",        #lisrel, or mx
         layout         = "tree",          #tree, circle, or spring
         structural     = F,               #or T for structural model only
         cut            = .60,            #cut the scaling of the paths (edges) at this value
         residScale     = 7,               #size of residual paths (edges)
         sizeMan        = 3,               #size of the manifest variables
         sizeLat        = 5,               #size of the latent variables
         intercepts     = F,               #should intercepts be included?
         optimizeLatRes = T,               #angle of the incoming residuals is optimized
         exoVar         = T,               #should variances of exo variables be plotted?
         nCharNodes     = 0,               #number of characters to abbreviate node labels
         asize          = 1.5,             #arrow head size
         esize          = 1,               #arrow wheight
         edge.color     = 1,               #path (edge) color (1-255)
         edge.label.cex = .5,              #path (edge) label size
         cardinal       = F,               #or T for arrows pointing in the middle of a variable
         nDigits        = 3,               #number of digits for coeffiecients
         rotation       = 1)               #rotation of the whole model (1,2,3,4)
```

Hier werden alle gerechneten *fixed-links* Modelle tabelliert. Die Faktorladungen der Variable *C*
sind alle auf 1 fixiert. Die Faktorladungen der Variable *exp* sind in der Tabelle notiert.

Nr. | Kategorie      | Verlauf von *exp*    |   CS  | df   |     *p* | CFI |   RMSEA   | SRMR |
--- | -------------- | -------------------- | ----- | ---- | ------- | --- | --------- | ---- |
1   | logarithmisch  | log(1:4) (neg. Var!) |       |      |         |     |           |      |
2   | linear         | 1 2 3 4              |  17.4 |   4  |   < .01 | .89 | .11 - .17 | .34  |
3   | monoton steig. | 0 1 2 4 (neg. Var!)  |       |      |         |     |           |      |
4   | monoton steig. | 1 2 4 8              |   6.7 |   4  |    .153 | .98 | .02 - .10 | .12  |
5   | exp            | 1 4 9 16             |   4.2 |   4  |    .375 | .99 | .00 - .07 | .06  |

* Modell 1 weist auf Prädiktor 1 eine **negative** Residualvarianz auf
* Modell 3 weist auf Prädiktor 1 eine **negative** Residualvarianz auf
* Modelle 2, 4 und 5 konvergieren normal: alle Faktorladungen und Varianzen sind signifikant
* **Modell 5 repräsentiert die Daten am besten**
\pagebreak

# 4 Stabilität der Faktorwerte
## 4.1 Faktorwerte der *C*-Variable
Die Faktorwerte der konstanten Variable wurden für die Modelle 2, 4 und 5 extrahiert. Hier abgebildet
sind die Korrelationen dieser Faktorwerte.

```{r, echo = FALSE, warning=FALSE}
# .... 2.2 model 2 -------------------------------------------------
s2 <- 'C   =~ 1* S1mean + 1* S2mean + 1* S3mean + 1* S4mean
       exp =~ 1*S1mean +  
              2*S2mean + 
              3*S3mean + 
              4*S4mean

       C ~~ 0*exp'

s2fit <- sem(s2,
             data      = resultsSupp2,        #Datensatz mit den in sem.model verwendeten Variable
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.4 model 4 -------------------------------------------------
s4 <- 'C   =~ 1* S1mean + 1* S2mean + 1* S3mean + 1* S4mean
       exp =~ 1*S1mean +  
              2*S2mean + 
              4*S3mean + 
              8*S4mean

       C ~~ 0*exp'

s4fit <- sem(s4,
             data      = resultsSupp2,        #Datensatz mit den in sem.model verwendeten Variable
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)
# .... 2.5 model 5 -------------------------------------------------
s5 <- 'C   =~ 1* S1mean + 1* S2mean + 1* S3mean + 1* S4mean
       exp =~ 1*S1mean +  
              4*S2mean + 
              9*S3mean + 
              16*S4mean

       C ~~ 0*exp'

s5fit <- sem(s5,
             data      = resultsSupp2,        #Datensatz mit den in sem.model verwendeten Variable
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)

dat <- data.frame(matrix(0,nrow(resultsSupp2),0))

dat$Cmodel2 <- predict(s2fit)[,1]
dat$Emodel2 <- predict(s2fit)[,2]

dat$Cmodel4 <- predict(s4fit)[,1]
dat$Emodel4 <- predict(s4fit)[,2]

dat$Cmodel5 <- predict(s5fit)[,1]
dat$Emodel5 <- predict(s5fit)[,2]
```

```{r, echo = FALSE, warning=FALSE}
library(corrplot)
x1 <- cor(dat[c("Cmodel2", "Cmodel4", "Cmodel5")])

corrplot(x1,
         order = "original",
         type = "upper",
         diag = TRUE,
         addCoef.col = "white",
         insig = "blank",
         tl.srt=30,
         tl.col="black",
         tl.cex = .6,
         cl.cex = .6
         )
```

* Die Faktorwerte hängen stark miteinander zusammen
\pagebreak

## 4.1 Faktorwerte der *exp*-Variable
Die Faktorwerte der experimentellen Variable wurden für die Modelle 2, 4 und 5 extrahiert. Hier abgebildet
sind die Korrelationen dieser Faktorwerte.

```{r, echo = FALSE, warning=FALSE}
library(corrplot)
x2 <- cor(dat[c("Emodel2", "Emodel4", "Emodel5")])

corrplot(x2,
         order = "original",
         type = "upper",
         diag = TRUE,
         addCoef.col = "white",
         insig = "blank",
         tl.srt=30,
         tl.col="black",
         tl.cex = .6,
         cl.cex = .6
         )
```

* Die Faktorwerte hängen stark miteinander zusammen


# 5 Schlussfolgerung
Die Analyse der Faktorwerte deutet darauf hin, dass es für spätere Zusammenhänge
der *C*- und *exp*-Variable mit Drittvariablen nicht so entscheidend ist, welches Modell gewählt wird.
Aufgrund der Modelltests wähle ich **Modell 5** für meine weiteren Berechnungen.
