---
title: "Hick Messmodelle"
author: "Kongenerisches- und fixed-links Modelle im Vergleich"
date: "12 Februar 2016"
output:
  pdf_document:
    toc: false
    toc_depth: 3
classoption: a4paper
---

```{r setup, include=FALSE}
opts_chunk$set(dev = 'pdf')
```

```{r, echo = FALSE}
resultsHick <- read.csv("hicksupp.csv", sep = ",")
```

#1 Zusammenhänge der Bedingungen
```{r, echo=FALSE}
corr.test(resultsHick[24:27])
```


#2 Kongenerisches Modell
```{r, echo=FALSE, fig.align='center'}
# .... 1.1 model specification -------------------------------------------------
congenericHick <- 'gHick =~ H0meanRT + H1meanRT + H2meanRT + H258meanRT
# H2meanRT ~~ H258meanRT
'

congenericHickFit <- sem(congenericHick,
                     data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
                     estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
                     mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)

# .... 1.5 Plotten -------------------------------------------------------------
par(mfrow=c(1,1))
semPaths(congenericHickFit,
         what           = "std",           #std, or est
         style          = "lisrel",        #lisrel, or mx
         layout         = "tree",          #tree, circle, or spring
         structural     = F,               #or T for structural model only
         cut            = .60,            #cut the scaling of the paths (edges) at this value
         residScale     = 7,               #size of residual paths (edges)
         sizeMan        = 7,               #size of the manifest variables
         sizeLat        = 5,               #size of the latent variables
         intercepts     = F,               #should intercepts be included?
         optimizeLatRes = T,               #angle of the incoming residuals is optimized
         exoVar         = T,               #should variances of exo variables be plotted?
         nCharNodes     = 0,               #number of characters to abbreviate node labels
         asize          = 1.5,             #arrow head size
         esize          = 1,               #arrow wheight
         edge.color     = 1,               #path (edge) color (1-255)
         edge.label.cex = .5,              #path (edge) label size
         cardinal       = F,               #or T for arrows pointing in the middle of a variable
         nDigits        = 3,               #number of digits for coeffiecients
         rotation       = 1)               #rotation of the whole model (1,2,3,4)
```



Chi-Square | df   |     *p* | CFI |   RMSEA   | SRMR | parsimony ratio |
---------- | ---- | ------- | --- | --------- | ---- | --------------- |
      42.3 |   2  |  < .001 | .87 | .26 - .41 | .06  |             .33 |




#3 *fixed-links* Modelle
```{r, echo=FALSE, fig.align='center'}
flHick <- 'C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 0* H0meanRT + 1* H1meanRT + 2* H2meanRT + 2.58* H258meanRT          #bei der 4 will er etwas mehr als 4 :)

           C ~~ 0*exp
           '


# .... 2.2 fit -----------------------------------------------------------------
flHickFit <- sem(flHick,
                     data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
                     estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
                     mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.5 Plotten -------------------------------------------------------------
semPaths(flHickFit,
         what           = "std",           #std, or est
         style          = "lisrel",        #lisrel, or mx
         layout         = "tree",          #tree, circle, or spring
         structural     = F,               #or T for structural model only
         cut            = .60,            #cut the scaling of the paths (edges) at this value
         residScale     = 7,               #size of residual paths (edges)
         sizeMan        = 3,               #size of the manifest variables
         sizeLat        = 5,               #size of the latent variables
         intercepts     = F,               #should intercepts be included?
         optimizeLatRes = T,               #angle of the incoming residuals is optimized
         exoVar         = T,               #should variances of exo variables be plotted?
         nCharNodes     = 0,               #number of characters to abbreviate node labels
         asize          = 1.5,             #arrow head size
         esize          = 1,               #arrow wheight
         edge.color     = 1,               #path (edge) color (1-255)
         edge.label.cex = .5,              #path (edge) label size
         cardinal       = F,               #or T for arrows pointing in the middle of a variable
         nDigits        = 3,               #number of digits for coeffiecients
         rotation       = 1)
```

Hier werden alle gerechneten *fixed-links* Modelle tabelliert. Die Faktorladungen der Variable *C*
sind alle auf 1 fixiert. Die Faktorladungen der Variable *exp* sind in der Tabelle notiert.

Nr. | Kategorie      | Verlauf von *exp*    |   CS  | df   |     *p* | CFI |   RMSEA   | SRMR |
--- | -------------- | -------------------- | ----- | ---- | ------- | --- | --------- | ---- |
1   | logarithmisch  | log(1:4) (neg. Var!) |       |      |         |     |           |      |
2   | linear         | 1 2 3 4              |  39.5 |   4  |  < .001 | .89 | .17 - .28 | .17  |
3   | Anzahl bit     | 0 1 2 2.58           |  34.4 |   4  |  < .001 | .90 | .15 - .26 | .14  |
4   | monoton steig. | 0 1 2 4              |  29.2 |   4  |  < .001 | .91 | .13 - .24 | .12  |
5   | exp            | 1 4 9 16             |  12.6 |   4  |    .013 | .97 | .06 - .17 | .07  |
6   | Antwortalter.  | 1 2 4 6              |   9.6 |   4  |    .047 | .98 | .03 - .15 | .09  |
7   | logistisch     | .2 2.2 7.7 9.7       |   5.2 |   4  |    .267 |   1 | .00 - .11 | .08  |

* Modell 1 weist negative Residualvarianzen auf
* Modelle 2 bis 7 konvergieren normal: alle Faktorladungen und Varianzen sind signifikant
* **Modell 7 repräsentiert die Daten am besten**
\pagebreak

# 4 Stabilität der Faktorwerte
## 4.1 Faktorwerte der *C*-Variable
Die Faktorwerte der konstanten Variable wurden für die Modelle 2 bis 7 extrahiert. Hier abgebildet
sind die Korrelationen dieser Faktorwerte.

```{r, echo = FALSE, warning=FALSE}
# h1 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
#            exp =~ 0 * H0meanRT + 
#                   0.6931472 * H1meanRT + 
#                   1.0986123  * H2meanRT + 
#                   1.3862944  * H258meanRT
# 
#            C ~~ 0*exp'
# 
# h1fit <- sem(h1,
#              data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
#              estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
#              mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.2 model 2 -------------------------------------------------
h2 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 1 * H0meanRT + 
                  2 * H1meanRT + 
                  3  * H2meanRT + 
                  4  * H258meanRT

           C ~~ 0*exp'

h2fit <- sem(h2,
             data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.3 model 3 -------------------------------------------------
h3 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 0 * H0meanRT + 
                  1 * H1meanRT + 
                  2  * H2meanRT + 
                  2.58  * H258meanRT

           C ~~ 0*exp'

h3fit <- sem(h3,
             data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.4 model 4 -------------------------------------------------
h4 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 0 * H0meanRT + 
                  1 * H1meanRT + 
                  2  * H2meanRT + 
                  4  * H258meanRT

           C ~~ 0*exp'

h4fit <- sem(h4,
             data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.5 model 5 -------------------------------------------------
h5 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 1 * H0meanRT + 
                  4 * H1meanRT + 
                  9  * H2meanRT + 
                  16  * H258meanRT

           C ~~ 0*exp'

h5fit <- sem(h5,
             data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)


# .... 2.6 model 6 -------------------------------------------------
h6 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 1 * H0meanRT + 
                  2 * H1meanRT + 
                  4  * H2meanRT + 
                  6  * H258meanRT

           C ~~ 0*exp'

h6fit <- sem(h6,
             data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)

# .... 2.7 model 7 -------------------------------------------------
h7 <- '    C   =~ 1* H0meanRT + 1* H1meanRT + 1* H2meanRT + 1* H258meanRT
           exp =~ 0.02297737 * H0meanRT + 
                  0.2227001 * H1meanRT + 
                  0.7772999  * H2meanRT + 
                  0.9770226  * H258meanRT

           C ~~ 0*exp'

h7fit <- sem(h7,
             data      = resultsHick,        #Datensatz mit den in sem.model verwendeten Variablen
             estimator = "MLM",      #Schätzmethode ist die robuste Variante von ML
             mimic     = "Mplus")    #man kann den Output von Mplus (default ist EQS)

dat <- data.frame(matrix(0,nrow(resultsHick),0))

# dat$Cmodel1  <- predict(h1fit)[,1]
# dat$Emodel1  <- predict(h1fit)[,2]

dat$Cmodel2  <- predict(h2fit)[,1]
dat$Emodel2  <- predict(h2fit)[,2]

dat$Cmodel3  <- predict(h3fit)[,1]
dat$Emodel3  <- predict(h3fit)[,2]

dat$Cmodel4  <- predict(h4fit)[,1]
dat$Emodel4  <- predict(h4fit)[,2]

dat$Cmodel5  <- predict(h5fit)[,1]
dat$Emodel5  <- predict(h5fit)[,2]

dat$Cmodel6  <- predict(h6fit)[,1]
dat$Emodel6  <- predict(h6fit)[,2]

dat$Cmodel7  <- predict(h7fit)[,1]
dat$Emodel7  <- predict(h7fit)[,2]
```

```{r, echo = FALSE, warning=FALSE}
library(corrplot)
x1 <- cor(dat[c("Cmodel2", "Cmodel3", "Cmodel4", "Cmodel5", "Cmodel6", "Cmodel7")])

corrplot(x1,
         order = "original",
         type = "upper",
         diag = TRUE,
         addCoef.col = "white",
         insig = "blank",
         tl.srt=30,
         tl.col="black",
         tl.cex = .6,
         cl.cex = .6
         )
```

* Die Faktorwerte hängen stark miteinander zusammen
\pagebreak

## 4.1 Faktorwerte der *exp*-Variable
Die Faktorwerte der experimentellen Variable wurden für die Modelle 2 bis 7 extrahiert. Hier abgebildet
sind die Korrelationen dieser Faktorwerte.

```{r, echo = FALSE, warning=FALSE}
library(corrplot)
x2 <- cor(dat[c("Emodel2", "Emodel3", "Emodel4", "Emodel5", "Emodel6", "Emodel7")])

corrplot(x2,
         order = "original",
         type = "upper",
         diag = TRUE,
         addCoef.col = "white",
         insig = "blank",
         tl.srt=30,
         tl.col="black",
       tl.cex = .6,
         cl.cex = .6
         )
```

* Die Faktorwerte hängen stark miteinander zusammen


# 5 Schlussfolgerung
Die Analyse der Faktorwerte deutet darauf hin, dass es für spätere Zusammenhänge
der *C*- und *exp*-Variable mit Drittvariablen nicht so entscheidend ist, welches Modell gewählt wird.
Aufgrund der Modelltests wähle ich **Modell 7** für meine weiteren Berechnungen.