
# Writing the dwe function -----------------------------------------------------
dwe <- function(x) {y <- x[!is.na(x)]
                    a <- y
                    b <- y
                    p <- outer(b, a, function(b, a) abs((b - a)))
                    n <- colSums(p) / length(y)
                    w <- 1 / n
                    sum(y * w) / sum(w)
                    }

# RTs of subject 189 -----------------------------------------------------------
H0sampledata   <- c(257,201,201,331,214,209,193,216,204,277,235,207,218,198,759,674,314,236,205,279,199,199,256,256,437,237,262,252,235,215,260)
H1sampledata   <- c(279,251,287,270,410,278,252,300,254,346,242,268,322,244,268,326,248,271,242,348,233,856,796,326,412,423,506,289,333,378,480)
H2sampledata   <- c(355,546,1085,365,463,378,392,448,718,515,506,444,655,562,541,599,419,446,484,324,581,428,449,863,558,667,409,330,442,700)
H258sampledata <- c(526,717,366,299,613,420,288,600,504,535,665,457,816,718,1305,805,521,392,543,788,461,390,385,477,478,397,482,833,537,382,444)

plot(density(H0sampledata, bw = 35))
mean(H0sampledata)
dwe(H0sampledata)

mean(H1sampledata)
dwe(H1sampledata)

mean(H2sampledata)
dwe(H2sampledata)

mean(H258sampledata)
dwe(H258sampledata)

a <- c(1:10,20,50,100)
hist(a)
mean(a)
dwe(a)
median(a)
